<!--pages/mine/mine.wxml-->
<import src="../../templates/template.wxml"/> 
<view class="main" bindtap='cancelDel'>
    <view class="header">
        <view class="lf">
            <open-data  type="userAvatarUrl"  class="avatar"></open-data>
        </view>
        <view class="nickName lf">
            <open-data  type="userNickName" class="uname"></open-data>
            <view bindtap="goScore">我的积分：{{signData.userScore}} ></view>
        </view>
        <button class="rt" wx:if="{{!signData.sigined}}" bindtap="showSign">签到领取礼物</button>
        <button class="rt" wx:if="{{signData.sigined}}" bindtap="showSign">今日已签到</button>   
        
    </view>


    <view class="content">
        <view class="clear">
            <view class="lf {{currentIndex==0?'current':''}}" bindtap="changeView" data-idx="0">收到的</view>
            <view class="lf {{currentIndex==1?'current':''}}" bindtap="changeView" data-idx="1">送出的</view>
        </view>
        <scroll-view class="receive" wx:if="{{currentIndex==0}}" style="" scroll-y="true" bindscrolltoupper='lastPage' bindscrolltolower='nextPage' id="receive">

            <view wx:if="{{user.receive.length==0}}" class="empty">
                <image src="../../images/girl.png"></image>
                <text class="center">礼物空空，还未收到任何礼物哦~</text> 
            </view>

            <view hover-class='view-hover' wx:for="{{user.receive}}" wx:key="unique" wx:for-index="idx" data-index="{{idx}}" data-from="receive" class="itemView" id='{{item.id}}' style="width:{{screenWidth*item.num}}px;top:{{idx*180}}rpx;left:{{item.left}}px" bindtouchstart="touchstart" bindtouchmove="touchmove" wx:if="{{item.id}}" bindlongpress='longtapEvent'>
                    <form report-submit bindsubmit="formSubmit" id='{{item.id}}' data-index="{{idx}}" data-from="receive" wx:if="!lock">
                    <button class="formBtn" style="width:{{screenWidth}}px" formType="submit"></button>
                    </form>
                    <image src="{{item.gift_img}}" class="lf"></image>

                    <view class="lf son2">
                        <text class="title">{{item.gift_name}}</text>
                        <text>\n{{item.create_time}}</text>
                    </view>

                    <view class="son4 rt" wx:if="{{!item.confirm && !android}}" catchtap='confirmEvent' style="width:{{screenWidth * (item.num - 1)}}px" data-index="{{idx}}" data-from="receive">删除</view>
                    <view class="son4 rt" wx:if="{{item.confirm && !android}}"  style="width:{{screenWidth*(item.num-1)}}px" catchtap='deleteEvent' data-index="{{idx}}" data-from="receive">确认删除</view>

                    <view class="son3 rt" style="right:{{26+screenWidth*(item.num-1)}}px">
                        <text class="title">{{item.total_price==0?'免费':'￥'+item.total_price}}</text>
                        <text class="{{item.status=='已过期'?'black':''}}">{{item.status}}</text>
                    </view>

                    <view class="son5" wx:if="{{android && item.showDel}}" bindtap="deleteEvent" data-index="{{idx}}" data-from="receive">删除该礼物</view>

            </view>
            <view class="notice center {{opc1}}" style="width:{{screenWidth}}px;top:{{user.receive.length*180}}rpx" wx:if="{{showNotice1}}">阿哦，没有更多数据了╮(╯▽╰)╭</view>
        </scroll-view>

        <scroll-view class="give" wx:if="{{currentIndex==1}}" style="" scroll-y="true" bindscrolltoupper='lastPage' bindscrolltolower='nextPage' id="give">

            <view hover-class='view-hover' wx:for="{{user.give}}" wx:key="unique" wx:for-index="idx" data-index="{{idx}}" data-from="give" class="itemView" id='{{item.id}}' style="width:{{screenWidth*item.num}}px;top:{{idx*180}}rpx;left:{{item.left}}px" bindtouchstart="touchstart" bindtouchmove="touchmove" wx:if="{{item.id}}" bindlongpress='longtapEvent'>
                    
                    <form report-submit id='{{item.id}}' catchsubmit="formSubmit" data-index="{{idx}}" data-from="give">
                    <button class="formBtn" style="width:{{screenWidth}}px" formType="submit"></button>
                    </form>

                    <image src="{{item.gift_img}}" class="lf"></image>
                    <view class="lf son2">
                        <text class="title">{{item.gift_name}}</text>
                        <text>\n{{item.create_time}}</text>
                    </view>

                    <view class="son4 rt" wx:if="{{!item.confirm && !android}}" catchtap='confirmEvent' style="width:{{screenWidth * (item.num - 1)}}px" data-index="{{idx}}" data-from="give">删除</view>

                    <view class="son4 rt" wx:if="{{item.confirm && !android}}" style="width:{{screenWidth*(item.num-1)}}px" catchtap='deleteEvent' data-index="{{idx}}" data-from="give">确认删除</view>

                    <view class="son3 rt" style="right:{{26+screenWidth*(item.num-1)}}px">
                        <text class="title">{{item.total_price==0?'免费':'￥'+item.total_price}}</text>
                        <text class="{{item.status=='已过期'?'black':''}}">{{item.status}}</text>
                    </view> 

                    <view class="son5" wx:if="{{android && item.showDel}}" bindtap="deleteEvent" data-index="{{idx}}" data-from="give">删除该礼物</view> 

            </view>

            <view class="notice center {{opc2}}" style="width:{{screenWidth}}px;top:{{user.give.length*180}}rpx" wx:if="{{showNotice2}}">阿哦，没有更多数据了╮(╯▽╰)╭</view>

        </scroll-view>

    </view>


    <template is="signIn" data="{{...signData}}"></template>  

</view>
<import src="../../templates/auth/auth.wxml" />
<template data="{{authorizeBoard}}" is="auth"></template>